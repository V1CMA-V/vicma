---
import ContactCard from '@/components/freelance/ContactCard.astro'
import TextSections from '@/components/freelance/TextSections.astro'
---

<section
  id='contact'
  class='w-full max-w-6xl mx-auto py-24 px-4 md:px-8 flex flex-col items-center text-center'
>
  <TextSections section='Contacto'>
    <span slot='title'>Contáctame</span>
    <span slot='description'>
      Puedes contactarme también por correo o WhatsApp. Estoy disponible para responder cualquier
      duda sobre tu proyecto.
    </span>
  </TextSections>

  <div class='grid grid-cols-1 md:grid-cols-2 gap-6'>
    <ContactCard id='left' title='¿Prefieres escribirme directamente?'>
      <p class='text-pretty'>
        Puedes contactarme también por correo o WhatsApp. Estoy disponible para responder cualquier
        duda sobre tu proyecto.
      </p>
      <ul class='text-sm text-white/90 space-y-2 text-pretty'>
        <li><strong>Email:</strong> vicma.dev@hotmail.com</li>
        <li>
          <strong>WhatsApp:</strong>
          <a href='https://wa.me/525560908911' target='_blank' rel='noopener noreferrer'>
            +52 5560908911
          </a>
        </li>
        <li><strong>Ubicación:</strong> Puebla, México</li>
      </ul>
    </ContactCard>

    <ContactCard id='right' title='Disponibilidad y atención'>
      <p class='text-white/80 mb-2 text-pretty'>
        Respondo mensajes en el mismo día. Para reuniones o seguimiento, estos son mis horarios:
      </p>
      <ul class='text-sm text-white/90 space-y-1 text-pretty'>
        <li><strong>Lunes a Viernes:</strong> 9:00 AM – 6:00 PM</li>
        <li><strong>Sábados:</strong> 10:00 AM – 2:00 PM</li>
        <li><strong>Zona horaria:</strong> GMT-6 (CDMX)</li>
      </ul>
    </ContactCard>

    <ContactCard id='center' title='¿Tienes un proyecto en mente?' highlight>
      <p>Completa el formulario y te responderé en menos de 24 horas.</p>
      <form action='https://formspree.io/f/mnndzajl' method='post'>
        <label for='email'>Tu correo</label>
        <input name='email' id='email' type='email' />
        <button type='submit'>Enviar</button>
      </form>
    </ContactCard>

    <div
      id='success-modal'
      class='fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 hidden'
    >
      <div class='bg-white text-black rounded-2xl shadow-lg max-w-sm w-full p-6 text-center'>
        <h2 class='text-xl font-bold mb-2'>
          <span class='text-black'>¡Gracias por tu mensaje!</span>
        </h2>
        <p class=''><span class='text-gray-700'>Te responderé muy pronto.</span></p>
        <button
          onclick="document.getElementById('success-modal').classList.add('hidden')"
          class='mt-4 bg-accent text-white px-4 py-2 rounded-full hover:bg-accent-hover transition cursor-pointer'
        >
          Cerrar
        </button>
      </div>
    </div>
  </div>
</section>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.querySelector('form')
    const modal = document.getElementById('success-modal')

    form.addEventListener('submit', async e => {
      e.preventDefault()
      const formData = new FormData(form)

      try {
        const res = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            Accept: 'application/json',
          },
        })

        if (res.ok) {
          form.reset() // Limpia campos
          modal.classList.remove('hidden') // Muestra modal
        } else {
          alert('Hubo un error al enviar el mensaje.')
        }
      } catch (err) {
        alert('Error al conectar con el servicio de correo.')
      }
    })
  })
</script>
